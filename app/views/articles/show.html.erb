<! –– # rendered via `def index` in `controllers/articles_controller.rb` ––>

<h1><%= link_to "Anonymous Community Blog", "/", :method => "get", class: "title" %></h1>

<h2><%= @article.title %></h2>

<div class='article-container'>

  <p class="article-p"><%= @article.body %></p>

  <ul class='article-actions'>

    <li><%= link_to "Edit", edit_article_path(@article), :class => "article-links" %></li>

    <li><%= link_to "Delete", article_path(@article), data: {
      turbo_method: :delete,
      turbo_confirm: "Are you sure?"
    }, :class => "article-links"%></li>

  </ul>
</div>


<! –– # display comments ––>

<section class='everything-comments'>
  <article class='comments-box'>
    <h3>Comments</h3>

    # iterate over @article.comments collection in views/comments/_comment.html.erb, & assign each comment to local var w/ same name as partial (in this case "comment"), which is then available to show in partial

    <%= render @article.comments %>
    
  </article>

  <! –– # add "create new comment" form (calls "CommentsController create action") ––>

  <! –– # `form_with` call uses an array, which will build a nested route, such as /articles/1/comments ––>
  <%= form_with model: [ @article, @article.comments.build ] do |form| %>

    <div class='add-comment-section'>
    
      <button id='addCommentBtn' onclick="showCommentForm()">Add A Comment</button>

      <div class="comment-form hidden" id='commentForm'>

        <p class='comment-input-container'>
          <%= form.label :commenter, 'Name' %><br>
          <%= form.text_field :commenter, :required => 'required' %>
        </p>
        <p class='comment-input-container'>
          <%= form.label :body, 'Comment' %><br>
          <%= form.text_area :body, :required => 'required' %>
        </p>
        <p>
          <%= form.submit %>
        </p>
      </div>
    </div>

  <% end %>
</section>

<! –– # javascript ––>

<script>
  const showCommentForm = () => {
    document.getElementById("commentForm").classList.remove("hidden");
    document.getElementById("addCommentBtn").classList.add("hidden");
  }
</script>